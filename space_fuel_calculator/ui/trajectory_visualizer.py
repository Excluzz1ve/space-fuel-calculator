"""
–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ—Ç–æ–≤ —Å –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –º–∞–Ω–µ–≤—Ä–∞–º–∏.
"""
from typing import List, Optional, Tuple
from datetime import datetime

from ..models.planet import Planet


class TrajectoryVisualizer:
    """
    –ö–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ—Ç–æ–≤.
    """
    
    @staticmethod
    def format_trajectory_with_gravity_assists(origin: Planet, destination: Planet, 
                                             base_delta_v: float, use_assists: bool = True) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –ø–æ–ª–µ—Ç–∞ —Å –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –º–∞–Ω–µ–≤—Ä–∞–º–∏.
        
        Args:
            origin: –ü–ª–∞–Ω–µ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            destination: –ü–ª–∞–Ω–µ—Ç–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
            base_delta_v: –ë–∞–∑–æ–≤–∞—è –¥–µ–ª—å—Ç–∞-V –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–æ–ª–µ—Ç–∞ (–º/—Å)
            use_assists: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞–Ω–µ–≤—Ä—ã
            
        Returns:
            –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
        """
        lines = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        lines.append("üó∫Ô∏è –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –¢–†–ê–ï–ö–¢–û–†–ò–ò –ü–û–õ–ï–¢–ê")
        lines.append("=" * 50)
        
        # –¢–∏–ø —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
        trajectory_type = "—Å –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –º–∞–Ω–µ–≤—Ä–∞–º–∏" if use_assists else "–ø—Ä—è–º–∞—è"
        lines.append(f"\nüìç –¢–∏–ø —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏: {trajectory_type}")
        
        # –ú–∞—Ä—à—Ä—É—Ç
        lines.append(f"\nüöÄ –ú–∞—Ä—à—Ä—É—Ç: {origin.name} ‚Üí {destination.name}")
        
        # –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
        lines.append(f"\nüõ∞Ô∏è –°—Ö–µ–º–∞ –ø–æ–ª–µ—Ç–∞:")
        
        if use_assists:
            # –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è —Å –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –º–∞–Ω–µ–≤—Ä–∞–º–∏
            lines.append("   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê")
            lines.append(f"   ‚îÇ  üåç {origin.name:<15} ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ ü™ê –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞  ‚îÇ")
            lines.append("   ‚îÇ                    ‚ï≤                      ‚îÇ")
            lines.append("   ‚îÇ                     ‚ï≤ (–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π     ‚îÇ")
            lines.append("   ‚îÇ                      ‚ï≤ –º–∞–Ω–µ–≤—Ä)            ‚îÇ")
            lines.append("   ‚îÇ                       ‚ï≤                   ‚îÇ")
            lines.append(f"   ‚îÇ                        ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ üåå {destination.name:<15} ‚îÇ")
            lines.append("   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò")
        else:
            # –ü—Ä—è–º–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è
            lines.append("   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê")
            lines.append(f"   ‚îÇ  üåç {origin.name:<15} ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ üåå {destination.name:<15} ‚îÇ")
            lines.append("   ‚îÇ                                             ‚îÇ")
            lines.append("   ‚îÇ           (–ø—Ä—è–º–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è)               ‚îÇ")
            lines.append("   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò")
        
        # –î–µ—Ç–∞–ª–∏ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
        lines.append(f"\nüìä –î–µ—Ç–∞–ª–∏ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏:")
        
        # –†–∞—Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
        if use_assists:
            # –°–∏–º—É–ª—è—Ü–∏—è —ç–∫–æ–Ω–æ–º–∏–∏ –æ—Ç –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–∞–Ω–µ–≤—Ä–æ–≤ (10-30%)
            assist_efficiency = 0.2  # 20% —ç–∫–æ–Ω–æ–º–∏—è
            effective_delta_v = base_delta_v * (1 - assist_efficiency)
            fuel_savings = assist_efficiency * 100
            
            lines.append(f"   ‚Ä¢ –ë–∞–∑–æ–≤–∞—è –¥–µ–ª—å—Ç–∞-V (–ø—Ä—è–º–æ–π –ø–æ–ª–µ—Ç): {base_delta_v:,.0f} –º/—Å ({base_delta_v/1000:.1f} –∫–º/—Å)")
            lines.append(f"   ‚Ä¢ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–µ–ª—å—Ç–∞-V (—Å –º–∞–Ω–µ–≤—Ä–∞–º–∏): {effective_delta_v:,.0f} –º/—Å ({effective_delta_v/1000:.1f} –∫–º/—Å)")
            lines.append(f"   ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è –æ—Ç –º–∞–Ω–µ–≤—Ä–æ–≤: {base_delta_v - effective_delta_v:,.0f} –º/—Å ({(base_delta_v - effective_delta_v)/1000:.1f} –∫–º/—Å)")
            lines.append(f"   ‚Ä¢ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–∞–Ω–µ–≤—Ä–æ–≤: {fuel_savings:.1f}%")
            
            # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –º–∞–Ω–µ–≤—Ä–æ–≤
            lines.append(f"\nüõ∞Ô∏è –¢–æ—á–∫–∏ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–∞–Ω–µ–≤—Ä–æ–≤:")
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é –ø–ª–∞–Ω–µ—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ä–±–∏—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞–¥–∏—É—Å–æ–≤
            if origin.orbital_radius < destination.orbital_radius:
                # –ü–æ–ª–µ—Ç –∫ –≤–Ω–µ—à–Ω–µ–π –ø–ª–∞–Ω–µ—Ç–µ - –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Æ–ø–∏—Ç–µ—Ä –¥–ª—è –º–∞–Ω–µ–≤—Ä–∞
                intermediate_planet = "–Æ–ø–∏—Ç–µ—Ä"
                maneuver_benefit = "—É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏"
            else:
                # –ü–æ–ª–µ—Ç –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ø–ª–∞–Ω–µ—Ç–µ - –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –í–µ–Ω–µ—Ä—É –¥–ª—è –º–∞–Ω–µ–≤—Ä–∞
                intermediate_planet = "–í–µ–Ω–µ—Ä–∞"
                maneuver_benefit = "–∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è"
            
            lines.append(f"   1. üìç {intermediate_planet} - {maneuver_benefit}")
            lines.append(f"      ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è –¥–µ–ª—å—Ç–∞-V: {(base_delta_v - effective_delta_v):,.0f} –º/—Å")
            lines.append(f"      ‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏")
            
        else:
            # –ü—Ä—è–º–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è
            lines.append(f"   ‚Ä¢ –û–±—â–∞—è –¥–µ–ª—å—Ç–∞-V: {base_delta_v:,.0f} –º/—Å ({base_delta_v/1000:.1f} –∫–º/—Å)")
            lines.append(f"   ‚Ä¢ –¢–∏–ø –º–∞–Ω–µ–≤—Ä–∞: –ø—Ä—è–º–æ–π –ø–µ—Ä–µ–ª–µ—Ç –ø–æ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –ì–æ–º–∞–Ω–∞")
            lines.append(f"   ‚Ä¢ –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –º–∞–Ω–µ–≤—Ä—ã: –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç")
        
        # –û–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
        lines.append(f"\nüìä –û–ë–©–ò–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò –¢–†–ê–ï–ö–¢–û–†–ò–ò:")
        
        final_delta_v = effective_delta_v if use_assists else base_delta_v
        lines.append(f"   ‚Ä¢ –û–±—â–∞—è –¥–µ–ª—å—Ç–∞-V: {final_delta_v:,.0f} –º/—Å ({final_delta_v/1000:.1f} –∫–º/—Å)")
        
        # –†–∞—Å—á–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª–µ—Ç–∞
        # –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞: –≤—Ä–µ–º—è ‚âà —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ / —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å
        distance_au = abs(destination.orbital_radius - origin.orbital_radius) / 1.496e11
        estimated_flight_time_days = distance_au * 365 / 2  # –ü—Ä–∏–º–µ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
        
        lines.append(f"   ‚Ä¢ –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: {distance_au:.2f} –∞.–µ.")
        lines.append(f"   ‚Ä¢ –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞: {estimated_flight_time_days:.0f} –¥–Ω–µ–π ({estimated_flight_time_days/365:.1f} –ª–µ—Ç)")
        
        if use_assists:
            lines.append(f"\nüîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä—è–º–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–µ–π:")
            lines.append(f"   ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è –¥–µ–ª—å—Ç–∞-V: {base_delta_v - effective_delta_v:,.0f} –º/—Å")
            lines.append(f"   ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–ø–ª–∏–≤–∞: ~{fuel_savings:.1f}%")
            lines.append(f"   ‚Ä¢ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª–µ—Ç–∞: ~{estimated_flight_time_days * 0.2:.0f} –¥–Ω–µ–π")
            lines.append(f"   ‚Ä¢ –°–ª–æ–∂–Ω–æ—Å—Ç—å –º–∏—Å—Å–∏–∏: –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è (—Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)")
        
        # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        lines.append(f"\n‚è±Ô∏è –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:")
        lines.append(f"   ‚Ä¢ –û–∫–Ω–æ –∑–∞–ø—É—Å–∫–∞: –∫–∞–∂–¥—ã–µ {distance_au * 2:.1f} –ª–µ—Ç (—Å–∏–Ω–æ–¥–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–∏–æ–¥)")
        lines.append(f"   ‚Ä¢ –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏: {'–≤—ã—Å–æ–∫–∞—è' if use_assists else '—Å—Ä–µ–¥–Ω—è—è'}")
        lines.append(f"   ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏: {'–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è' if use_assists else '—Ö–æ—Ä–æ—à–∞—è'}")
        
        # –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        lines.append(f"\nüí° –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:")
        if use_assists:
            lines.append(f"   ‚Ä¢ –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞–Ω–µ–≤—Ä—ã —Ç—Ä–µ–±—É—é—Ç –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏")
            lines.append(f"   ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–ø–ª–∏–≤–∞ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –º–∏—Å—Å–∏–∏")
            lines.append(f"   ‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –º–∏—Å—Å–∏–π —Å –±–æ–ª—å—à–æ–π –º–∞—Å—Å–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏")
        else:
            lines.append(f"   ‚Ä¢ –ü—Ä—è–º–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ—â–µ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏")
            lines.append(f"   ‚Ä¢ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö –º–∏—Å—Å–∏–π –∏ –Ω–µ–±–æ–ª—å—à–∏—Ö –∞–ø–ø–∞—Ä–∞—Ç–æ–≤")
            lines.append(f"   ‚Ä¢ –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏")
        
        lines.append(f"   ‚Ä¢ –†–∞—Å—á–µ—Ç—ã –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –æ—Ä–±–∏—Ç–∞–ª—å–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏")
        lines.append(f"   ‚Ä¢ –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑")
        
        # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
        lines.append(f"\nüìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞—Å—á–µ—Ç–µ:")
        lines.append(f"   ‚Ä¢ –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        lines.append(f"   ‚Ä¢ –ú–æ–¥–µ–ª—å: —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –æ—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞")
        lines.append(f"   ‚Ä¢ –¢–æ—á–Ω–æ—Å—Ç—å: ¬±10% (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞)")
        
        return "\n".join(lines)
    
    @staticmethod
    def format_maneuver_sequence(maneuvers: List[Tuple[str, float, str]]) -> str:
        """
        –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–∞–Ω–µ–≤—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        
        Args:
            maneuvers: –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (–Ω–∞–∑–≤–∞–Ω–∏–µ_–º–∞–Ω–µ–≤—Ä–∞, –¥–µ–ª—å—Ç–∞_v, –æ–ø–∏—Å–∞–Ω–∏–µ)
            
        Returns:
            –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –º–∞–Ω–µ–≤—Ä–æ–≤
        """
        if not maneuvers:
            return "–ú–∞–Ω–µ–≤—Ä—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
        
        lines = []
        lines.append("üõ∞Ô∏è –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–∞–Ω–µ–≤—Ä–æ–≤:")
        
        total_delta_v = 0
        for i, (name, delta_v, description) in enumerate(maneuvers, 1):
            total_delta_v += delta_v
            lines.append(f"   {i}. {name}")
            lines.append(f"      ‚Ä¢ –î–µ–ª—å—Ç–∞-V: {delta_v:,.0f} –º/—Å ({delta_v/1000:.1f} –∫–º/—Å)")
            lines.append(f"      ‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ: {description}")
            lines.append("")
        
        lines.append(f"üìä –û–±—â–∞—è –¥–µ–ª—å—Ç–∞-V –≤—Å–µ—Ö –º–∞–Ω–µ–≤—Ä–æ–≤: {total_delta_v:,.0f} –º/—Å ({total_delta_v/1000:.1f} –∫–º/—Å)")
        
        return "\n".join(lines)
    
    @staticmethod
    def format_orbital_elements(planet: Planet) -> str:
        """
        –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—Ä–±–∏—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–ª–∞–Ω–µ—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        
        Args:
            planet: –ü–ª–∞–Ω–µ—Ç–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            
        Returns:
            –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –æ—Ä–±–∏—Ç–∞–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
        """
        lines = []
        lines.append(f"ü™ê –û—Ä–±–∏—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–∞–Ω–µ—Ç—ã {planet.name}:")
        lines.append(f"   ‚Ä¢ –ú–∞—Å—Å–∞: {planet.mass:.2e} –∫–≥")
        lines.append(f"   ‚Ä¢ –†–∞–¥–∏—É—Å: {planet.radius/1000:.0f} –∫–º")
        lines.append(f"   ‚Ä¢ –û—Ä–±–∏—Ç–∞–ª—å–Ω—ã–π —Ä–∞–¥–∏—É—Å: {planet.orbital_radius/1.496e11:.3f} –∞.–µ.")
        lines.append(f"   ‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å —É–±–µ–≥–∞–Ω–∏—è: {planet.escape_velocity/1000:.1f} –∫–º/—Å")
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—á–µ—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        orbital_velocity = (1.327e20 / planet.orbital_radius) ** 0.5  # –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
        lines.append(f"   ‚Ä¢ –û—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: {orbital_velocity/1000:.1f} –∫–º/—Å")
        
        surface_gravity = 6.674e-11 * planet.mass / (planet.radius ** 2)
        lines.append(f"   ‚Ä¢ –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è: {surface_gravity:.1f} –º/—Å¬≤")
        
        return "\n".join(lines)